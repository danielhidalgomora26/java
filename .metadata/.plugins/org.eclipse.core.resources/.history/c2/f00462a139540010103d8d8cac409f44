package com.krakedev.persistencia.servicios;

import java.math.BigDecimal;
import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.SQLException;
import java.sql.Time;
import java.text.ParseException;
import java.text.SimpleDateFormat;
import java.util.Date;

import com.krakedev.persistencia.entidades.Persona;
import com.krakedev.persistencia.utils.ConexionBDD;

public class AdminPersonas {
	public static void insertar(Persona persona) {
		Connection con=null;
		PreparedStatement ps;
		try {
			//abrir conexion
			con=ConexionBDD.conectar();
			ps = con.prepareStatement("insert into persona(cedula_persona, nombre, apellido, numero_hijos, estatura,cantidad_ahorrada,fecha_nacimiento,hora_nacimiento) values (?, ?, ?, ?,?,?,?,?)");
			ps.setString(1, persona.getCedula());
			ps.setString(2, persona.getNombre());
			ps.setString(3, persona.getApellido());
			ps.setInt(4, persona.getNumeroHijos());
			ps.setDouble(5, persona.getEstatura());		
			ps.setBigDecimal(6, persona.getCantidadAhorrada());
	
			
			SimpleDateFormat sdf = new SimpleDateFormat("yyyy/MM/dd hh:mm:s");
			String fechaStr = "2022/03/22 10:05:04";
			
			String fechaStrR = "2025/06/27 16:10:24";
			
			try {
				Date fecha = sdf.parse(fechaStr);
				System.out.println(fecha);
				long fechaMilis = fecha.getTime();
				System.out.println(fechaMilis);
				java.sql.Date fechaSQL = new java.sql.Date(fechaMilis);
				System.out.println(fechaSQL);

				Time timeSQL = new Time(fechaMilis);
				System.out.println(timeSQL);
				
				ps.setDate(7, fechaSQL);
				ps.setTime(8, timeSQL);
				
				ps.executeUpdate();
				System.out.println("ejecuta insert");
		}catch(Exception e) {
			//mostrar el error al usuario
			System.out.println(e.getMessage());
			//loggear el error
			e.printStackTrace();
		}finally {
			//cerrar la conexion  
			try {
				con.close();
			} catch (SQLException e) {			
				e.printStackTrace();
				System.out.println("Error de infraestructura");
			}
		}
		}
}
	

